\documentclass[12pt,class=article,crop=false]{standalone} 
\input{../preamble.tex}

\begin{document}
\subsection{Invariant EKF}
TODO: add group-affine definition. 

Let $ \eta = X^{-1} \wh{ X} $ be the left-invariant error. In EKF, $ \wh{ X}$ represents estimated state and $ X$ is the true state, where they share the same deterministic dynamics and only differ in initial state. In the context of uncertainty propagation, $ X$ is modeled by a stochastic process governed by an SDE, and $ \wh{ X}$ is the propagated mean.

When the dynamics $ f_u$ is group-affine, the evolution of the error $ \eta$ satisfies
\begin{align*}
	\frac{d}{dt} \eta = g_u (\eta)
\end{align*}
where $ g_u$ satisfies $ g_u(\eta) = f_u(\eta) - f_u( Id) \eta$. It turns out that $ g_u$ can be converted to a linear dynamic under the exponential coordinates. Let  $ (A \xi) ^\wedge$ be the first-order approximation of  $ g_u (\exp (\xi))$. Then we have $ \eta = \exp( \xi)$ for all time where
\begin{align*}
	\frac{d}{dt} \xi = A \xi .
\end{align*}
This means that the error $ \eta$ is trajectory-independent and can be linearized in the Lie algebra without approximation. 

Note that if $ f_u$ is affine (\emph{i.e.} $ f_u(x) = f_0 + Ax + Bu$), we know that the error has the linear dynamics  $ \dot{e} = A e$, independent of the state-trajectory. This is a generalization of that.

So in a stochastic setting, if the drift of SDE is group-affine, then no matter how state deviates from the mean, the drift error is trajectory-independent and can be propagated using the same ODE in the Lie algebra. If the drift is not group-affine, then using the drift equation (Ricatti?) along the mean trajectory should give additional error.

Euler-Poincare Equation:
\begin{align*}
	\mathbb{I} \dot{\xi} = \ad_{ \xi}^* ( \mathbb{I} \xi) + u 
\end{align*}

\end{document}
