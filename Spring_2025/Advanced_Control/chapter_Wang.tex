\documentclass[12pt,class=article,crop=false]{standalone}
\input{./preamble_Wang.tex}
\input{./preamble.tex}
\begin{document}

In Chapter 6, we established conditions for controllability on control-affine systems. Now we turn our attention to a specific control-affine system called the \emph{bilinear system}, which has the following form:
\begin{equation} \label{eq:matrix_eq} 
	\dot{X}(t) = \left( A + \sum_{ i= 1}^{ m} u_i(t) B_i \right) X(t) .
\end{equation}
Here capital letters represent matrices, and $ u \in U$ for some set of admissible controls $ U$ with values in  $ \rr^{m}$. It turns out that if $ X$ belong to a Lie group and $ A, B_1,\ldots,B_m$ belong to its Lie algebra, then under certain conditions we can establish global controllability on the bilinear system and obtain stronger results than Chapter 6.

\section{Lie Theory}
Let us first develop some background knowledge on Lie groups and their Lie algebras.
\begin{defn}
A \emph{monoid} $ (S,*)$ is a set $ S$ endowed with a binary operation  $ *: S \times S \to S$ that satisfies two axioms:
\begin{itemize}
	\item The binary operation is associative. That is, $ a*(b*c) = (a*b)*c$ for all  $ a,b,c \in S$.
	\item There exists a two-sided identity $ e$. That is, $ e*g=g*e=g$ for all  $ g \in G$.
\end{itemize}
\end{defn}
It follows that the identity element must be unique: $ e = e *e' = e'$.
\begin{defn}
A \emph{group} $ (G,*)$ is a monoid that satisfies an additional axiom:
\begin{itemize}
\item For any $g \in G $, there exists a two-sided inverse $ g^{-1}$. That is, $ g*g^{-1} = g^{-1}*g = e$.
\end{itemize}
\end{defn}
An inverse of $ g$ is unique: if $ hg = e = h'g$, then $ h = h(gh) = h'(gh) =h'$.

For convenience, we refer to any monoid or group by its set when the binary operation is clear from context. 

\begin{defn}
A (real) \emph{Lie group} $ G$ is a group that is also a smooth manifold such that group multiplication $ \mu: G \times G \to G, (g,h) \mapsto gh$ and inversion $ \iota: G \to G, g \mapsto g^{-1}$ are smooth maps.
\end{defn}
\begin{defn}
A \emph{Lie group morphism} is a smooth map and a group homomorphism. 
\end{defn}
\begin{defn}
	An \emph{immersed subgroup}\footnote{We use the term ``immersed subgroup'' instead of ``Lie subgroup'' because the latter usually refers to an embedded subgroup in the literature.} $ H$ of a Lie group $ G$ is a subgroup of  $ G$ such that the inclusion map $ H \xhookrightarrow{ } G $ is an injective immersion and a group homomorphism.

\end{defn}

We turn to Lie algebras next. We have learned about the Lie algebra of vector fields in Chapter 5. It turns out that every Lie group is associated with a canonical Lie algebra, namely the tangent space at the identity element. To endow this vector space with a Lie algebra structure, we shall rely on the known Lie algebra structure on the set of vector fields of a manifold.
 
\begin{defn}
	A \emph{right-invariant vector field} $ f: G \to TG$ on $ G$ satisfies $ (R_g)_* f (h) = f(hg)$, where $ R_g: G \to G, h \mapsto hg$ is right multiplication by $ g$.
\end{defn}
\begin{remark}
A similar definition exists for a \emph{left-invariant vector field} using the left multiplication map $ L_g$. In this chapter, we solely focus on right-invariant vector fields since results for left-invariant vector fields exactly mirror that of right-invariant vector fields.
\end{remark}
From the definition of a right-invariant vector field, we see that as soon as we define $ f$ on a single point,  $ f$ is defined on the entire group. Therefore, the evaluation map at identity is a bijection between right-invariant vector fields and their values at the identity, \emph{i.e.} all vectors in  $T_eG $. It is easy to check that this bijection is a linear isomorphism. Denote the right-invariant vector field corresponding to $ v \in T_eG$ as $ \xi_v$. Thus, we can now define a Lie bracket on $ T_eG$ using the Lie bracket defined on  $ \mathcal{ V}(G)$: for any $ v,w \in T_eG$, we have 
\begin{align*}
	[v,w] \defeq [\xi_v, \xi_w](e),
\end{align*}
where we set $ p = e $ in the definition from Theorem 5.42.
\begin{defn}
The Lie algebra $ \mathfrak{g} $ of a Lie group $ G$ is  $ T_eG$ endowed with the Lie bracket defined above. We also use  $\LieA{ G}$ to denote the Lie algebra of $ G$ to avoid ambiguity.
\end{defn}
We adopt the tradition to use Fraktur script for Lie algebras and capital letters for groups.
\begin{remark}
If $ \mathcal{ A}$ is a set of right-invariant vector fields, then $ \LieA{ \mathcal{ A} }$ denotes the Lie algebra generated by $ \mathcal{ A}$. If $ G$ is a Lie group, then  $ \LieA{ G}$ denotes the Lie algebra of a Lie group. 
\end{remark}
Next, we introduce the exponential map of a Lie group.
\begin{fact}
Let $ G$ be a Lie group and  $ \mathfrak{g} $ its Lie algebra. For any $ v \in \mathfrak{g} $, there exists a unique Lie group morphism $ \gamma_v: \rr \to G $ that satisfies $\gamma(0) = e$ and  $\dot{ \gamma_v}(0) = v$. This morphism is called the \emph{one-parameter subgroup corresponding to $ v$}. 
\end{fact}
Uniqueness is immediate from uniqueness of ODE. Existence in a small time interval is given by the flow, and can be extended to the entire real line once we show $ \gamma_v(s+t) = \gamma_v(s) \gamma_v(t)$ using right-invariance. See Proposition 3.1 of \cite{TODO} for a complete proof.

We note that the naming is an abuse of terminology: it is only the image of $ \gamma_v$ that is an immersed subgroup.
\begin{defn}
	The \emph{exponential map} $ \exp: \mathfrak{g} \to G $ of a Lie group $ G$ is defined as
	\begin{align*}
		\exp(v) = \gamma_v(1) .
	\end{align*}
\end{defn}
Whenever an operation has been defined on set elements, we can define the same operation on sets by collecting all outputs from performing the operation elementwise. For example, we write $ \exp( \mathfrak{g} ) \defeq  \{ \exp( v): v \in \mathfrak{g} \}$.
\begin{theorem} \label{thm:subgroup}
Let $ G$ be a Lie group, and let  $ H$ be a path-connected subgroup of  $ G$. Then  $ H$ is an immersed subgroup of  $ G$.
\end{theorem}
TODO proof.

We note that the notions of connectedness and path-connectedness for a manifold are interchangeable since any manifold inherits local path-connectedness from the Euclidean space, the key criterion for the two notions to be equivalent.

\begin{fact} \label{ fact:sub_correspond} 
Let $ G$ be a Lie group. Then there is a one-to-one correspondence between its connected immersed subgroups and Lie subalgebras of $ \LieA{ G}$. More specifically, any connected immersed subgroup $ H$ corresponds to the Lie subalgebra  $ \LieA{ H}$, and any Lie subalgebra $ \mathfrak{h} $ corresponds to the connected immersed subgroup $ \exp( \mathfrak{h} )$. This correspondence is easily checked to be order preserving with respect to set containment.
\end{fact}
See JOHNLEE \cite{TODO} Theorem 19.26 for a proof.

\begin{defn}
We introduce some common real Lie groups and their Lie algebras below.
\begin{enumerate}[label=(\roman*)]
	\item The Euclidean space $ \rr^{n}$ is an abelian Lie group under vector addition. Its Lie algebra is $ \rr^{n}$ as a vector space with the trivial Lie bracket.
	\item The \emph{general linear group} $ \text{GL}_{ n}(\rr) $ is the group of $ n\times n$ invertible real matrices under matrix multiplication. Its Lie algebra $ \mathfrak{gl}(n) $ is the vector space of all $ n\times n$ matrices with the commutator Lie bracket $ [X,Y] = XY-YX$.
	\item The \emph{special orthogonal group} $ \text{ SO}(n) \subset  \text{GL}_{ n}(\rr) $ is the group of orthogonal matrices with determinant 1. Its Lie algebra $ \mathfrak{so}(n) $ is the vector space of all skew-symmetric $ n\times n$ matrices with the commutator Lie bracket.
	\item The \emph{special Euclidean group} $ \text{SE}(n) $ is the semidirect product of $ \rr^{n}$ and $ \text{SO}(n) $. It has elements with matrix form $ \begin{pmatrix} R&v\\0&1 \end{pmatrix} $, where $ R \in \text{SO}(n)$ and $ v \in \rr^{n}$. Its Lie algebra $ \mathfrak{se}(n) $ has elements with matrix form $ \begin{pmatrix} R&v\\0&0 \end{pmatrix} $, where $ R \in \text{SO}(n) $ and $ v \in \rr^{n}$.
\end{enumerate}
\end{defn}

We can now rewrite \cref{eq:matrix_eq} using Lie-theoretic language. Let $ G$ be a Lie group and $ U$ be the set of admissible controls with values in  $ \rr^{m}$. A bilinear system is equivalent to the form described by right-invariant vector fields:
\begin{align}\label{eq:group_eq} 
	\dot{x}(t) =\xi_a(x(t)) + \sum_{ i= 1}^{ m} u_i(t) \xi_{b_i} (x(t)),
\end{align}
where $ x \in G$, $ u \in U$, and $ a, b_i \in \mathfrak{g} $.


Throughout the chapter, we shall assume that the admissible set $ U$ is one of the three classes  $ U_u, U_r$, or  $ U_b$:
\begin{enumerate}[label=(\roman*)]
	\item The unrestricted control $ U_u$ is the class of all locally bounded and measurable functions defined on the interval  $ [0,\infty)$ with values in $ \rr^{m}$.
	\item The restricted control $ U_r \subset U_u$ consists of all elements which take values in the unit hypercube $ \{x \in \rr^{m}, \norm{ x}_{ \infty} \leq 1 \} $. 
	\item The bang-bang control $ U_b$ is the class of all piecewise constant functions defined on  $ [0,\infty)$ with values in $ \{\pm 1\}^{m}$.
\end{enumerate}

From now on, let $ \mathcal{ A} = \{a,b_1,\ldots,b_m\} $. We abbreviate \cref{eq:group_eq}  to $ ( \mathcal{ A},U)$ and treat tangent vectors at $ e$ and right-invariant vector fields interchangably.

\section{Reachable Sets of the Bilinear System}
\begin{prop}
Let $ ( \mathcal{ A}, U)$ be a right-invariant system on $ G$, and let  $ u \in U$. Then for every $ g \in G$, there exists a unique solution $ x$ of \cref{eq:group_eq} , defined for  $ 0 \leq t < \infty$, such that $ x(0) = g$.
\end{prop}
\begin{proof}
	Since \cref{eq:group_eq}  is continuous in $ t$ and locally Lipschitz continuous in  $ x$ (due to smothness), Picard--Lindel\"{o}f Theorem guarantees uniqueness and local existence of the solution in a time interval $ [0,T)$ with $ x(0) = g$ for some $ T>0$. We wish to show that $ T = \infty$. Suppose not, then let $ y(t)$ be the solution of  \cref{eq:group_eq} in the time interval $ [T- \epsilon, T+ \epsilon]$ for some $ \epsilon > 0$ with $ y(T) = e$. Let $g' = y\left( T- \frac{1}{2} \epsilon \right)$ and $ g''=  x\left( T- \frac{1}{2} \epsilon \right) $. Define
 \begin{align*}
 	z(t) = \begin{cases}
		x(t) & 0 \leq t \leq T - \frac{1}{2} \epsilon , \\
		y(t)(g')^{-1} g'' & T - \frac{1}{2} \epsilon < t \leq T + \epsilon .
 	\end{cases}
 \end{align*}
 By right-invariance, $ z(t)$ is a solution to  \cref{eq:group_eq} for the time interval $ [0, T+ \epsilon)$, a contradiction. Thus, the solution is defined for $ [0, \infty)$. 
\end{proof}
Since the solution is determined by a $ u \in U$ and initial condition $ g \in G$, we shall denote it by $ \pi (g,u, \cdot )$. 

\begin{remark}
Due to the right invariance of the system, we have $ \ReachT( g) = \ReachT( e) g$, $ \ReachTe( g) = \ReachTe( e) g$, and $ \mathcal{R}( g) = \mathcal{R}( e) g$. Therefore, it suffices to study the reachable sets from the identity.
\end{remark}

We now discuss the roadmap to prove controllability on \cref{eq:group_eq} . Since reachable set is defined as the solution to the system governed by the vector fields, it is reasonable to suspect that the reachable set might be the connected immersed subgroup corresponding to the Lie subalgebra generated by these vector fields. Thus if the vector fields generated $ \mathfrak{g} $, then the reachable set would be the entire group if the group is connected, yielding controllability.


\begin{defn}
We set up the notations for the following two Lie subalgebras and their corresponding connected immersed subgroups:
\begin{enumerate}[label=(\roman*)]
	\item $ \mathfrak{a} \defeq  \LieA{ \mathcal{ A}}$ and $ S_a \defeq  \exp( \mathfrak{a} )$.
	\item  $ \mathfrak{b} \defeq  \LieA{ \mathcal{ B}} $ and $ S_b \defeq  \exp( \mathfrak{b} )$.
\end{enumerate}
\end{defn}


\begin{lemma} \label{lem:subset} 
Let $ (\mathcal{A},U)$ be a right-invariant control system on $G$. Then $ \mathcal{R}( e) $ is contained in $ S_a$.
\end{lemma}

\begin{lemma}
	Let $ (\mathcal{A},U)$ be a right-invariant control system on $G$. For each $ g \in G$ and $ T \geq 0$, the map $ \varphi : U(T) \times [0,T] \to G, (u,t) \mapsto \pi( g,u,t) $ is continuous with respect to the topology of weak convergence on $ U(T)$. TODO Lemma 4.3+4.4.
\end{lemma}
A proof can be found in  \cite{[10]}.
\begin{lemma} \label{lem:path_conn} 
Let $ (\mathcal{A},U)$ be a right-invariant control system on $G$. 
\begin{enumerate}[label=(\roman*)]
	\item The sets $ \ReachT( e) $, $ \ReachTe( e) $, and $ \mathcal{R}( e) $ are path-connected for each $ T \geq 0$.
	\item If  $ U = U_r$, then  $ \ReachT( e) $ and $ \ReachTe( e) $ are compact.
\end{enumerate}
\end{lemma}
\begin{proof}
	Since image of a path-connected/compact set under a continuous function remains path-connected/compact, (ii) follows immediately; it remains to show that $ U(T)$ is path-connected. Since $ U_u$ and  $ U_r$ are convex, they are path-connected by linear interpolations. If  $ U = U_b$, given $ u,v \in U(T)$ we construct the following path: given $ t \in [0,T]$, we define
\begin{align*}
	w_t (\tau) = \begin{cases}
		v(\tau) & 0\leq \tau \leq t\\
		u(\tau) & t< \tau \leq T.
	\end{cases}
\end{align*}
The concatenation of bang-bang controls remains a bang-bang control, so $ w_t \in U(T)$. Moreover, $ w_0 = u$,  $ w_T = v$, and  $ w: [0,T] \to U(T)$ is clearly continuous and thus a path. Hence, (i) follows.
\end{proof}
\begin{prop} \label{prop:monoid} 
Let $ ( \mathcal{ A}, U)$ be a right-invariant control system on $ G$. Then $ \mathcal{R}( e) $ is a monoid.
\end{prop}
\begin{proof}
Clearly $ e \in \mathcal{R}( e) $. Let $ g ,g' \in \mathcal{R}( e) $. By definition of $ \mathcal{R}( e) $, there exists $ u,u' \in U$ and $ t,t' \geq 0$ such that  $ g = \pi( e,u,t)$ and $ g' = \pi( e,u',t')$. Now define a control
\begin{align*}
	v(s) =  \begin{cases}
		u(s) & 0\leq s \leq t,\\
		u'(s-t) & s>t.
	\end{cases}
\end{align*}
Since it is piecewise admissible, under the three classes of control it remains admissible. Notice that $ \pi( e,v,t+t') = gg'$. Thus $ \mathcal{R}( e) $ is closed under multiplication. Since multiplication of a Lie group is associative, we conclude that $ \mathcal{R}( e) $ is a monoid.
\end{proof}

\begin{theorem} \label{thm:reach_subgroup} 
Let $ (\mathcal{A},U)$ be a right-invariant control system on $G$. If $ \mathcal{R}( e) $ is a subgroup of $ G$, then  $ \mathcal{R}( e) = G$.

\end{theorem}
\begin{proof}
	Since $ \mathcal{R}( e) $ is path-connected and is a subgroup of $ G$, by \cref{thm:subgroup} $ \mathcal{R}( e) $ is an immersed subgroup of $ G$. By \cref{lem:subset}, $ \mathcal{R}( e) $ is also an immersed subgroup of $ S_a$. Therefore,  $ \LieA{ \mathcal{R}( e) } \subset \mathfrak{a} $. To prove the other direction of containment, notice that since $ \mathfrak{a} $ is generated by $ \mathcal{ A}$, we can recover $ \mathcal{ A}$ from the set $ \mathcal{ A}'$ where each element has the form
\begin{align*}
	a_u \defeq a+ \sum_{ i= 1}^{ m} u_i b_i 
\end{align*}
with each $ u_i \equiv \pm 1$. Thus $ \mathcal{ A}'$ is another generating set of $ \mathfrak{a} $. Since $ u$ is a constant control, the solution to the system is simply  $\exp(t a_u) $ which by definition of $ \mathcal{R}( e) $ is contained in $ \mathcal{R}( e) $ for all $ t \geq 0$. Since  $ \mathcal{R}( e) $ is a subgroup, its inverse $ \exp( -t a_u)$ must also be contained in $ \mathcal{R}( e) $ for all $ t \geq 0$. This means  $ \exp( ta_u) \subset \mathcal{R}( e) $ for all $ t \in \rr$. Taking the time derivative of $ \exp( t a_u)$ at $ t=0$, we obtain  $ a_u \in T_e \mathcal{R}( e) \defeq  \LieA{ \mathcal{R}( e) }$. It follows that $ \mathfrak{a} = \LieA{ \mathcal{R}( e) }$ and therefore $ S_a = \mathcal{R}( e) $ by \cref{ fact:sub_correspond}. 
\end{proof}

\section{Controllability}
We have established the general tools needed to establish controllability. Next we consider a simpler case where the system is driftless, \emph{i.e.} $ a=0$. It is also refered to as \emph{homogeneous} system in the literature. In this case, $ \LieA{ \mathcal{ A}} = \LieA{ \mathcal{ B}}$, and reachable set is completely determined by $ \mathcal{ B}$.
\begin{theorem}\label{thm:driftless} 
Let $ (\mathcal{A},U)$ be a driftless right-invariant control system on $G$. Then we have $ \mathcal{R}( e) = S_b$. Moreover, if $ U = U_u$, then for all  $ T>0$, we have  $ \ReachT( e) = \mathcal{R}( e) = S_b $.
\end{theorem}
\begin{proof}
The first statement follows from \cref{thm:reach_subgroup} once we show that $ \mathcal{R}( e) $ is a subgroup of $ S_b$. By \cref{prop:monoid}, $ \mathcal{R}( e) $ is already a monoid. Given $ g = \pi( e,u,t)$, $ u \in U$, $ t\geq 0$, we shall construct an inverse the following way. Let
 \begin{align*}
	v(s) \defeq \begin{cases}
		-u(t-s) & 0\leq s \leq t,\\
		u(s) & s>t .
	\end{cases}
\end{align*}
Again we can readily verify that $ v \in U$. Define $ f(s) = \pi( e,u,t-s)$ for $ 0\leq s \leq t$ and we observe that $ f(0) = \pi( e,u,t) = g$. Consider
\begin{align*}
	\frac{\d f}{\d s } &= \sum_{ i= 1}^{ m} -u_i(t-s) b_i\\
	&= \sum_{ i= 1}^{ n} v_i(s) b_i  .
\end{align*}
Therefore, as the solution to this system $ f(s) = \pi( g,v,s)$. By right-invariance of the system, we can rewrite $ f(s) = \pi( e,v,s) g$. But notice that $ \pi( e,v,t)g = f(t) = \pi( e,u,0) = e$. Thus, we conclude that $ g^{-1} = \pi( e,v,t)$ and therefore is in $ \mathcal{R}( e) $. That is, $ \mathcal{R}( e) $ is a subgroup of $ S_b$.

For the second statement, we set $ U = U_u$. Given  $ g = \pi( e,u,t)$ for some $ u \in U$ and $ t> 0$, again we shall construct a control to reach  $ g$ in arbitrarily small amount of time. Let $ s>0$ and  define
 \begin{align*}
	v(\tau) = \frac{t}{s} u\left( \frac{t \tau}{ s} \right) , \qquad \tau \in [,\infty).
\end{align*}
Notice that $ \pi( e,v,s) = \pi\left( e, \frac{t}{s} u(t),s \right) = \pi( e,u,t) =g$, where the second equality comes from reparameterizing curve by scaling the velocity. This is feasible only because the drift is 0. This shows that $ \Reacht( e)  \subset \mathcal{R}_s( e)$. Since $ s,t$ are arbitrary, by symmetry we have equality. That is, reachable set from identity is the same for all time greater than zero. The second statement follows immediately.
\end{proof}

Now we turn to the general case with drift.
\begin{defn}
A subset $ S$ of a topological space $ X$ is \emph{dense}  in  $ X$ if its closure $ \overline{S}$ equals $X$.
\end{defn}
\begin{defn}
A subset $ V$ is \emph{relatively open}  in a subset $ S $  of a topological space $ X$ if there exists an open set $ U$ in  $ X$ such that $ V = U \cap S$.
\end{defn}

From now on, we use the subspace topology of $ S_a$ inherited from $ G$ as the default topology.
\begin{fact} \label{fact:dense_int} 
Let $ (\mathcal{A},U)$ be a right-invariant control system on $G$. Then for each $ T>0$, we have $ \ReachT( e) \subset S_a$, and $ \intr \ReachT( e) $ is dense in $ \ReachT( e) $.
\end{fact}
A proof can be found in \cite{TODO}. 
\begin{lemma} \label{lem:subgroup_open} 
If $ H$ is a subgroup of a Lie group $ G$ and there exists a nonempty open set $U \subset H$, then $ H$ is open.
\end{lemma}
\begin{proof}
Since right multiplication is a homeomorphism and thus an open map, $ Uh$ is open. Since  $ H$ is a subgroup, we have $ Uh \subset H$. It follows that
 \begin{align*}
	H = \bigcup_{ h \in H} Uh ,
\end{align*}
meaning that $ H$ is an union of open sets and therefore open.
\end{proof}

\begin{proposition} \label{prop:local_control_id} 
Let $ (\mathcal{A},U)$ be a right-invariant control system on $G$. Then $ ( \mathcal{ A},U)$ is controllable if and only if $ G$ is connected and  $ e \in \intr \mathcal{R}( e) $.
\end{proposition}
\begin{proof}
The forward direction is trivial. For the backward direction, since $ \intr \mathcal{R}( e)  \subset \mathcal{R}( e) $ is nonempty, by \cref{lem:subgroup_open} $ \mathcal{R}( e) $ is open.

Let $ \{x_n\} \subset \mathcal{R}( e) $ be a sequence with $ \lim_{ n \to \infty} x_n = x$. Then the sequence $ \{x x_n ^{-1}\} $ converges to $ e$. Since $ e \in \intr \mathcal{R}( e) $, there exists an $ N \in \nn$ such that $ x x_N ^{-1} \in \mathcal{R}( e) $. Since $ \mathcal{R}( e) $ is a monoid, the limit point $ x = x x_N ^{-1} x_N $ must be in $\mathcal{R}( e) $. This shows that $ \mathcal{R}( e) $ is closed.

Since $ G$ is connected and  $ \mathcal{R}( e) \subset G $ is nonempty and clopen, we have $ \mathcal{R}( e) = G $.
\end{proof}
In other words, this theorem says that local controllability at the identity is equivalent to global controllability when $ G$ is connected.
\begin{lemma}
Let $ (\mathcal{A},U)$ be a right-invariant control system on $G$. If $ \mathcal{R}( e) $ is dense in $ S_a$, then it equals $ S_a$.
\end{lemma}
\begin{proof}
Since $ \intr \mathcal{R}( e) $ is nonempty by \cref{fact:dense_int}, let $ g \in \intr \mathcal{R}( e) $ and $ V \subset \mathcal{R}( e) $ be an open neighborhood of $ g$. Let $ W = \{h^{-1}: h \in V\} $. Notice that $ W$ is nonempty because $ g^{-1} \in W$ and is open because inversion of a Lie group is a diffeomorphism and therefore an open map. Since $ \mathcal{R}( e) $ is dense in $ S_a$, its intersection with any open set is nonempty, and therefore there exists an $ h_0 \in W \cap \mathcal{R}( e) $. This implies that $ h_0^{-1} \in V$. Since right multiplication is also a diffeomorphism and thus an open map, $ Vh_0$ is open and contains the identity $ e$. Moreover, $ Vh_0 \subset \mathcal{R}( e) $ since $ \mathcal{R}( e) $ is a monoid by \cref{prop:monoid}. That is, $ \mathcal{R}( e) $ contains a neighborhood of the identity in $ S_a$. Since  $ S_a$ is connected, by \cref{prop:local_control_id}, we obtain  $ \mathcal{R}( e) = S_a $.
\end{proof}


\begin{theorem}\label{thm:compact} 
Let $ (\mathcal{A},U)$ be a right-invariant control system on $G$. Suppose $ S_a$ is compact. Then we have
 \begin{enumerate}[label=(\roman*)]
	\item $ \mathcal{R}( e) = S_a$;
	\item There exists a $ T>0$ such that  $ \ReachT( e)  = \mathcal{R}( e) $.
\end{enumerate}
\end{theorem}
\begin{proof}
Define $ H = \overline{ \mathcal{R}( e) }$. Since multiplication of a Lie group is continuous, it commutes with taking the limit, ensuring that all products of limit points of $ H$ are limit points of  $ H$ and thus remain in $ H$. Thus  $ H$ is a monoid. We wish to show that $ H$ is a group.

Given $ h \in H$, for any positive integer $ n$, we know $ h^{n} \in H$. Since $ S_a$ is compact, the sequence  $ \{h^{n}\} $ has a converging subsequence $ \{h^{n_k}\} $. We can WLOG assume $ n_k < n_{k+1}$ for all $ k$. Notice that
\begin{align*}
	h^{-1} = 1 \cdot h^{-1} = \lim_{ k \to \infty} \frac{h^{n_{k+1}}}{ h^{n_k}} h^{-1} = \lim_{ k \to \infty} h^{n_{k+1}-n_k -1} \defeq \lim_{ k \to \infty} h_k .
\end{align*}
Since $ n_{k+1} - n_k -1 \geq 0$ for each $ k$, we have $ h_k \in H$. As $ H$ is closed, it follows that  $ h^{-1}$ as a limit point of $ H$ is in $ H$. That is, $ H$ is a group.

Since $ \intr \mathcal{R}( e) \neq \O $, we also have $ \intr H \neq \O$. By \cref{lem:subgroup_open}, $ H$ is open. Since $ S_a$ is connected and  $ H$ is nonempty and clopen, it must be that  $ H = S$.
\end{proof}
\begin{corollary}
Let $ G$ be compact and  $ ( \mathcal{ A}, U)$ be controllable. Then there exists $ T>0$ such that, for every  $ g \in G$, $ g' \in G$, there is a control that steers $ g$ into  $ g'$ in less than  $ T$ units of time.
\end{corollary}

Now we are ready to present the main controllability results for the bilinear system \cref{eq:group_eq}.

\begin{theorem}
A necessary condition for $ ( \mathcal{ A},U)$ to be controllable is that $ G$ is connected and  $ \mathfrak{a} = \LieA{ G} $. If the system is driftless or $ G$  is compact, then the condition is also sufficient.
\end{theorem}
\begin{proof}
If the system is controllable, then we must have $ G= S_a$ which is connected. Then $ \LieA{ G} = \LieA{ S_a} = \mathfrak{a}$. If the system is driftless or $G$ is compact, then the other direction is proven by  \cref{thm:driftless} or  \cref{thm:compact}: if $ \mathfrak{a} = \LieA{ G} $, then $ \mathcal{R}( e) = S_a = G $. 
\end{proof}

Therefore, we have established that accessibility is equivalent to controllability when the system is driftless or when $ G$ is compact.



TODO: add results on semidirect product of Lie groups, including SE(n)?

So far, the results we obtain use Lie-theoretic machinery more or less can be derived from general control-affine theory on manifolds. However, the importance of developing Lie-theoretic tools can be highlighted by the next class of Lie groups. We first recall a definition from group theory:
\begin{defn}
Let $ V$ and  $ K$ be groups such that $ K$ acts on $ V$. The  \emph{semidirect product} $ V \rtimes K$ of $ V$ and  $ K$ is a group that shares the same underlying set as $ V \times K$ but its binary operation $ *$ is defined as
\begin{align*}
	(v_1,k_1) * (v_2,k_2) = (v_1 (k_1.v_2), k_1 k_2). 
\end{align*}
\end{defn}
Intuitively, a group action on a set permutes the elements of the set. Here $ k_1.v_1$ simply sends $ v_1$ to another element in $ V$ according to the action of  $ k_1$ on $ V$. We make this definition more concrete with an example.
\begin{example}
The special Euclidean group $ SE(n)$ is a Lie group semidirect product  $ \rr^{n} \rtimes \SO(n)$, where $ \rr^{n}$ is viewed as a Lie group under addition and $ SO(n)$ acts on  $ \rr^{n}$ by matrix multiplcation. Given $ v_1, v_2 \in V$ and $ R_1, R_2 \in SO(n)$, their product is
\begin{align*}
	(v_1, R_1)(v_2,R_2) = (v_1+ R_1v_2, R_1 R_2).
\end{align*}
Moreover, $ SE(n)$ can be embedded into  $ GL(n+1)$ by $ (v,R) \mapsto \begin{pmatrix} R & v\\ 0 &1 \end{pmatrix} $. Then matrix multiplication yields the same product as above.

In particular, $ SE(3)$ is the group of rigid-body transformations  in $ \rr^{3}$ and therefore plays a vital role in 6-DOF control of spacecrafts.
\end{example}
Therefore, the Lie theoretic machinery helps us establish controllability on some exotic manifolds not covered by the general manifold theory.

\begin{lemma}
Let $ (\mathcal{A},U)$ be a right-invariant control system on $G$. Then $ \mathfrak{a} = \LieA{ G}$ if and only if $ \intr \mathcal{R}( e) $ is nonempty.
\end{lemma}
\begin{proof}
The forward direction directly follows from the Accessibility Rank Condition in Theorem 6.9. For the backward direction, we prove the contrapositive. If the integral submanifold of $ \mathfrak{a} $ does not have full dimension, then the reachable set as a subset does not have full dimension either. That is,  $ \intr \mathcal{R}( e) = \O $.
\end{proof}

\begin{theorem}
Let $ (\mathcal{A},U)$ be a right-invariant control system on $G$, where $ G = V \rtimes K$ with $ V$ a vector space and  $ K$ compact and connected. Suppose that the action of $ K$ on $ V$ has no nontrivial fixed point, in the sense that  $ K.x = x$ holds only for  $ x=0$. Then $ (\mathcal{A},U)$ is controllable if and only if $ \mathfrak{a} = \LieA{ G}$.
\end{theorem}
A proof for the general case can be found in \cite{}. We shall only prove the case for $ G = SE(n)$. Since any rotation is invertible, $ SE(n)$ satisfies the assumption of the theorem.
\begin{proof}
The forward direction is immediate. For the backward direction, suppose $ \mathfrak{a} = \LieA{ G}$. By \cref{fact:}, $ \intr  \mathcal{R}( e) \neq \O $. By \cref{prop:}, it suffices to show that the identity $ e = (0,I) \in \intr \mathcal{R}( e) $. Let $ (x,k) \in \intr \mathcal{R}( e) $. Since $ K$ is compact and connected, it is a fact that the projection map $ \pi_K: V \rtimes  K \supset  \mathcal{R}( e) \to K  $ is surjective. Clearly $ k^{-1} \in K$. Therefore, there exists a $ y \in V$ such that $ (y,k^{-1}) \in \pi_K^{-1}(k^{-1}) \subset \mathcal{R}( e) $. Then $ (x,k)(y,k^{-1}) = (x+ky,I)$ is in the interior of $ \mathcal{R}( e)$ since right multiplication is an open map and $ \mathcal{R}( e) $ is a monoid.

Let $ v = x+ky$. Since $ (v,I)$ is an interior point of  $ \mathcal{R}( e) $, there exists a neighborhood $ \Omega$ of $ I$ such that  $ (v, \Omega) \subset \intr \mathcal{R}( e) $. For any $ h \in \Omega$, we have $ (v,h)^{n} = (v+hv+ \cdots + h^{n-1} v, h^{n}) \in \intr \mathcal{R}( e) $ again because right multiplication is an open map and $ \mathcal{R}( e) $ is a monoid. If we can find a $ w \in V$ and $ h \in \Omega$ such that $ v=(h-I)w$ and  $ h^{n} = I$, we would have
\begin{align*}
	v+ h v + \cdots + h^{n-1}v &= (I+h+ \cdots + h^{n-1})(h-I)w \\
	&= (h+ \cdots + h^{n-1}+ h^{n} - I - h - \cdots h^{n-1})w \\
	&= 0 ,
\end{align*}
and the theorem would be proved. For $ SE(n)$ we can proceed as follows. Choose any plane $ P$ that contains $ v$. We can always choose a large enough  $ n$ so that  $ h$ is a rotation within that plane by angle $ 2 \pi /n$ and remains inside an arbitrarily small neighborhood $ \Omega$ of $ I$. As long as the angle is small enough,  $ h-I$ restricted to  $ P$ is easily checked to be invertible, so we can choose $ w = ((h-I)|_P)^{-1}(v)$. This concludes the proof.
\end{proof}
TODO: add stronger results from Sachkov 2009.
\end{document}
